#include <8052.h>

unsigned char code display_seg[]={0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90,0x7f};
//unsigned char display_seg2[]={0xDF,0xEF,0xF7,0xFB,0xFD,0xFE};
unsigned char code display_seg2[]={0xFE,0xFD,0xFB,0xF7,0xEF,0xDF};
//unsigned char display_seg3[]={0x80,0x40,0x20,0x10,0x8,0x4,0x2,0x1};
unsigned char code display_seg3[]={0x1,0x2,0x4,0x8,0x10,0x20,0x40,0x80};
unsigned char code display_seg4[]={0xff,0x90,0x90,0x90,0x00,0xff,0x01,0x01,0xff,0x00,0x18,0x24,0x42,0x81,0x00,0xff,0x04,0x0a,0x11,0x00};
unsigned char code display_seg5[]={0x88,0x44,0x22,0x11};
unsigned char code display_seg6[]={0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x81,0x82,0x84,0x88,0x90,0xa0,0xc0,0xc1,0xc2,0xc4,0xc8,0xd0,0xe0,0xe1,0xe2,0xe4,0xe8,0xf0,0xf1,0xf2,0xf4,0xf8,0xf9,0xfa,0xfc,0xfd,0xfe,0xff,0x11};
//unsigned char display_seg4[]={0x8E,0xC1,0xC6,0x87};
//sbit a=P2^0;
#define int_from_bit(i) (1<<i)
#define set_bit(x,i,v) x=(v?(x|int_from_bit(i)):x&~int_from_bit(i))
#define get_bit(x,i) ((x&int_from_bit(i))!=0)
void delay(int i)
{
	int a,b;
	for(a=0;a<i;a++)
	{
		for(b=0;b<120;b++);
		//TF1=0;
		/*TH1=(65536-1000)/256;
		TL1=(65536-1000)%256;
		TR1=1;
		while(TF1==0);
		TF1=0;
		TR1=0;*/
	}
}

void main()
{
	int i=0;
	int i2=0;
	//unsigned char tmp=0;
	P2=0xFE;
	//a=1;
	set_bit(P2,0,1);
	while(1)
	{
		P1=~display_seg6[i];
		P0=display_seg[i2];
		while(!get_bit(P2,0));
		//a=a;
		i++;
		/*if(tmp==0)*/i2++;
		if(display_seg6[i]==0x11)i=0;
		if(i2>9)i2=0;
		//tmp++;
		//if(tmp>5)tmp=0;
		delay(200);
	}
}



